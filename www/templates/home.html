<ion-view view-title="We Change Makers">
  <ion-nav-buttons side="right">
    <button type="submit" class="button button-icon" ng-click="openPopover($event)">
      <i class="icon ion-android-list"></i>
    </button>
    <button type="submit" class="button button-icon" ng-click="findWarning()">
      <i class="icon ion-location"></i>
    </button>
  </ion-nav-buttons>

  <ion-content overflow-scroll="true">

  <ion-refresher on-refresh="doRefresh('init')">
  </ion-refresher>
    <ion-list>

      <!-- ========================== home_page ========================== -->
      <div id="home_page">

        <ion-item ng-repeat="card in allData.cards" class="posts">
          <div class="post-body">
            
            <div class="profile">
              <img ng-src="{{ card.user[0].userimage }}">
              <p class="username">{{card.user[0].username}}</p>
              <p class="date">{{ card.create_time }}</p>
              <button class="button button-icon float-edit" ng-style="userChecked(card)" ng-click="deleteCard(card.id)">
                  <i class="icon ion-ios-trash-outline"></i>
              </button>
              <button class="button button-icon float-edit" ng-style="userChecked(card)" ng-click="editCard(card.id)">  
                  <i class="icon ion-ios-compose-outline"></i>
              </button>
            </div>

            <div class="content">
              <a href="#" ng-click="showMap(card.location_lat, card.location_long)">
                <p class="fa fa-map-marker"> {{card.location_name}}</p>
              </a>
              <a ng-href="#/tab/home/{{ card.id }}">
                <div class="center-cropped post-image" style="background-image: url('{{card.img_path}}');">
                </div>
              </a>
              <h2><strong>{{card.title}}</strong></h2>
            </div>

            <div class="progress">
              <div class="progress-bar progress-bar-danger progress-bar-striped progress-{{card.status}}" role="progressbar" aria-valuenow="{{card.status}}" aria-valuemin="0" aria-valuemax="100" style="width: {{card.status}}%">
              </div>
            </div>
            <p class="progressText progress-{{card.status}}">{{ card.statusDescription }}</p>

            <div class="additional-function">
              <span>Watch {{ card.like_count }}</span>
              <span>댓글 {{ card.comments_count }}</span>
              <span>공유 0</span>
            </div>

            <div class="sns-link">
              <a href="#" ng-click="toggleLike(card.watch = !card.watch, card.id)" ng-class="{'active' : card.watch, 'non-active' : !card.watch}" id="like">
                <i class="fa fa-thumbs-up"></i> Watch
              </a>
              <a ng-href="#/tab/home/{{ card.id }}#comment"><i class="fa fa-commenting">
                </i> 댓글달기
              </a>
              <a href="#" id="sns-share"><i class="fa fa-share"></i> 공유하기</a>
            </div>

          </div>

        </ion-item>

        <ion-infinite-scroll on-infinite="doRefresh()" distance="10%">
        </ion-infinite-scroll>

      </div>
      <!-- ========================== home_page end ========================== -->
    </ion-list>
  </ion-content>
  <script id="templates/popover.html" type="text/ng-template">
    <ion-popover-view>
      <ion-content>
        <ion-radio ng-repeat="item in sortingTypeList"
            ng-value="item.value"
            ng-model="data.sortingType"
            ng-change="sortingTypeChange(item)">
          {{ item.text }}
        </ion-radio>
      </ion-content>
    </ion-popover-view>
  </script>
</ion-view>
